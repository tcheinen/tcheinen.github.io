<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer-when-downgrade">

    <title>Tenable CTF 2020</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="https:&#x2F;&#x2F;heinen.dev&#x2F;main.css">

    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://heinen.dev/atom.xml">
    

    
    
</head>
<body>
    <a class="skip-main" href="#main">Skip to content</a>
    <div class="container">
        <header> 
            <h1 class="site-header">
                <a href="https:&#x2F;&#x2F;heinen.dev">Teddy Heinen</a>
            </h1>
            <nav>
                
                
                
                <a  href="https:&#x2F;&#x2F;heinen.dev&#x2F;about&#x2F;">About</a>
                
                
                <a  href="https:&#x2F;&#x2F;heinen.dev&#x2F;tags&#x2F;">Tags</a>
                
                
            </nav>
        </header>
        <main id="main" tabindex="-1">
            

<article class="post">
    <header>
        <h1>Tenable CTF 2020</h1>
    </header>

    <ul class="toc">
	
	    <li>
	        <a href="https://heinen.dev/tenable-ctf-2020/#code">code</a>
	        
	            <ul class="toc">
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#short-and-sweet">short and sweet</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#hello-name">hello ${name}</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#print-n-lowest-numbers">print N lowest numbers</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#parsey-mcparser">parsey mcparser</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#random-encryption">random encryption</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#random-encryption-fixed">random encryption fixed</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#find-largest-triangle">find largest triangle</a>
	                    </li>
	                
	                    <li>
	                        <a href="https://heinen.dev/tenable-ctf-2020/#we-need-an-emulator">we need an emulator</a>
	                    </li>
	                
	            </ul>
	        
	    </li>
	
	</ul>

    <div class="content">
        <p>Tenable (the company who makes Nessus) ran a capture the flag over the weekend of February 19th.  I played for a few hours saturday night and pretty much cleared out the code category.  I've been a little starved for programming recently so I went straight for it haha.  Overall I'd say it was a pretty solid CTF -- I didn't devote the time needed to scope out every challenge but I had a fun time while I was playing.</p>
<span id="continue-reading"></span><h2 id="code">code</h2>
<h3 id="short-and-sweet">short and sweet</h3>
<pre style="background-color:#212733;">
<code class="language-python" data-lang="python"><span style="color:#ffa759;">def </span><span style="color:#ffd580;">AreNumbersEven</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">numbers</span><span style="color:#ccc9c2;">):
  </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">[x </span><span style="color:#f29e74;">% </span><span style="color:#ffcc66;">2 </span><span style="color:#f29e74;">== </span><span style="color:#ffcc66;">0 </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">x </span><span style="color:#ffa759;">in </span><span style="color:#ccc9c2;">numbers]

</span><span style="font-style:italic;color:#5c6773;"># Read space delimited integers from stdin and 
# pass a list of them to AreNumbersEven()
</span><span style="color:#ccc9c2;">numbers </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">raw_input</span><span style="color:#ccc9c2;">()
integer_list </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[</span><span style="font-style:italic;color:#5ccfe6;">int</span><span style="color:#ccc9c2;">(i) </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">i </span><span style="color:#ffa759;">in </span><span style="color:#ccc9c2;">numbers</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&#39; &#39;</span><span style="color:#ccc9c2;">)]
even_odd_boolean_list </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">AreNumbersEven</span><span style="color:#ccc9c2;">(integer_list)
</span><span style="color:#ffa759;">print </span><span style="color:#ccc9c2;">even_odd_boolean_list 
</span></code></pre><h3 id="hello-name">hello ${name}</h3>
<pre style="background-color:#212733;">
<code class="language-c" data-lang="c"><span style="color:#ffa759;">#include </span><span style="color:#bae67e;">&lt;stdio.h&gt;
</span><span style="color:#ffa759;">int </span><span style="color:#ffd580;">main</span><span style="color:#ccc9c2;">()
{
	</span><span style="color:#ffa759;">char</span><span style="color:#ccc9c2;"> buf[</span><span style="color:#ffcc66;">32</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#f28779;">fgets</span><span style="color:#ccc9c2;">(buf</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">32</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">stdin)</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#f28779;">printf</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;Hello </span><span style="color:#ffcc66;">%s</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> buf)</span><span style="color:#ccc9c2cc;">;
    </span><span style="color:#ffa759;">return </span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">}
</span></code></pre><h3 id="print-n-lowest-numbers">print N lowest numbers</h3>
<pre style="background-color:#212733;">
<code class="language-c++" data-lang="c++"><span style="color:#ffa759;">#include </span><span style="color:#bae67e;">&lt;iostream&gt;
</span><span style="color:#ffa759;">#include </span><span style="color:#bae67e;">&lt;algorithm&gt;
</span><span style="color:#ffa759;">#include </span><span style="color:#bae67e;">&lt;vector&gt;
</span><span style="color:#ffa759;">void </span><span style="color:#ffd580;">PrintNLowestNumbers</span><span style="color:#ccc9c2;">(</span><span style="color:#ffa759;">int </span><span style="color:#ffcc66;">arr</span><span style="color:#ccc9c2;">[]</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffa759;">unsigned int </span><span style="color:#ffcc66;">length</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffa759;">unsigned short </span><span style="color:#ffcc66;">nLowest</span><span style="color:#ccc9c2;">)
{
	std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">vector&lt;</span><span style="color:#ffa759;">int</span><span style="color:#ccc9c2;">&gt; </span><span style="color:#ffd580;">vec</span><span style="color:#ccc9c2;">(arr</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> arr </span><span style="color:#f29e74;">+</span><span style="color:#ccc9c2;"> length)</span><span style="color:#ccc9c2cc;">;

	</span><span style="color:#ccc9c2;">std</span><span style="color:#f29e74;">::</span><span style="color:#ffd580;">sort</span><span style="color:#ccc9c2;">(vec</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">begin</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">vec</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">end</span><span style="color:#ccc9c2;">())</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">int</span><span style="color:#ccc9c2;"> i </span><span style="color:#f29e74;">= </span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">for</span><span style="color:#ccc9c2;">(</span><span style="color:#ccc9c2cc;">;</span><span style="color:#ccc9c2;"> i </span><span style="color:#f29e74;">&lt;</span><span style="color:#ccc9c2;"> nLowest </span><span style="color:#f29e74;">- </span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">;</span><span style="color:#ccc9c2;"> i</span><span style="color:#f29e74;">++</span><span style="color:#ccc9c2;">) {
		std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">cout </span><span style="color:#f29e74;">&lt;&lt;</span><span style="color:#ccc9c2;"> vec[i] </span><span style="color:#f29e74;">&lt;&lt; </span><span style="color:#bae67e;">&quot; &quot;</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ccc9c2;">}
	std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">cout </span><span style="color:#f29e74;">&lt;&lt;</span><span style="color:#ccc9c2;"> vec[i]</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">}

</span><span style="color:#ffa759;">int </span><span style="color:#ffd580;">main</span><span style="color:#ccc9c2;">()
{
	</span><span style="color:#ffa759;">char</span><span style="color:#ccc9c2;"> input[</span><span style="color:#ffcc66;">0x100</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">int</span><span style="color:#ccc9c2;"> integerList[</span><span style="color:#ffcc66;">0x100</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">unsigned int</span><span style="color:#ccc9c2;"> length</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">unsigned short</span><span style="color:#ccc9c2;"> nLowest</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">	std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">cin </span><span style="color:#f29e74;">&gt;&gt;</span><span style="color:#ccc9c2;"> nLowest</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">	std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">cin </span><span style="color:#f29e74;">&gt;&gt;</span><span style="color:#ccc9c2;"> length</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">(</span><span style="color:#ffa759;">int</span><span style="color:#ccc9c2;"> i</span><span style="color:#f29e74;">=</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">;</span><span style="color:#ccc9c2;">i</span><span style="color:#f29e74;">&lt;</span><span style="color:#ccc9c2;">length</span><span style="color:#ccc9c2cc;">;</span><span style="color:#ccc9c2;">i</span><span style="color:#f29e74;">++</span><span style="color:#ccc9c2;">)
		 std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">cin </span><span style="color:#f29e74;">&gt;&gt;</span><span style="color:#ccc9c2;"> integerList[i]</span><span style="color:#ccc9c2cc;">;
	</span><span style="color:#ffd580;">PrintNLowestNumbers</span><span style="color:#ccc9c2;">(integerList</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> length</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> nLowest)</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">}
</span></code></pre><h3 id="parsey-mcparser">parsey mcparser</h3>
<pre style="background-color:#212733;">
<code class="language-python" data-lang="python"><span style="color:#ffa759;">import </span><span style="color:#ccc9c2;">re

</span><span style="font-style:italic;color:#5c6773;">&#39;&#39;&#39;
:param blob: blob of data to parse through (string)
:param group_name: A single Group name (&quot;Green&quot;, &quot;Red&quot;, or &quot;Yellow&quot;,etc...)

:return: A list of all user names that are part of a given Group
&#39;&#39;&#39;
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">ParseNamesByGroup</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">blob</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">group_name</span><span style="color:#ccc9c2;">):
    </span><span style="font-style:italic;color:#5c6773;"># print(group_name)
    </span><span style="color:#ccc9c2;">matches </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">re</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">findall</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="background-color:#ffa759;color:#ffffff;">\[</span><span style="color:#bae67e;">(.*?)</span><span style="background-color:#ffa759;color:#ffffff;">\]</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">blob)
    </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">[x[</span><span style="color:#bae67e;">&#39;user_name&#39;</span><span style="color:#ccc9c2;">] </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">x </span><span style="color:#ffa759;">in </span><span style="color:#ccc9c2;">[</span><span style="color:#f28779;">eval</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">{{</span><span style="color:#ffcc66;">{}</span><span style="color:#95e6cb;">}}</span><span style="color:#bae67e;">&quot;</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">format</span><span style="color:#ccc9c2;">(i)) </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">i </span><span style="color:#ffa759;">in </span><span style="color:#ccc9c2;">matches] </span><span style="color:#ffa759;">if </span><span style="color:#ccc9c2;">x[</span><span style="color:#bae67e;">&#39;Group&#39;</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">== </span><span style="color:#ccc9c2;">group_name]
    
data </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">raw_input</span><span style="color:#ccc9c2;">()
group_name </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&#39;|&#39;</span><span style="color:#ccc9c2;">)[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]
blob </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&#39;|&#39;</span><span style="color:#ccc9c2;">)[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]
result_names_list </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">ParseNamesByGroup</span><span style="color:#ccc9c2;">(blob</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">group_name)
</span><span style="color:#f28779;">print</span><span style="color:#ccc9c2;">(result_names_list)
</span></code></pre><h3 id="random-encryption">random encryption</h3>
<p>lmao it was in the provided source code hate to see it</p>
<p>flag: flag{n0t_that_r4ndom}</p>
<h3 id="random-encryption-fixed">random encryption fixed</h3>
<pre style="background-color:#212733;">
<code class="language-python" data-lang="python"><span style="color:#ffa759;">import </span><span style="color:#ccc9c2;">random
</span><span style="font-style:italic;color:#5c6773;"># flag = &quot;flag{not_the_flag}&quot;
</span><span style="color:#ccc9c2;">res </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[</span><span style="color:#ffcc66;">184</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">161</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">235</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">97</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">140</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">111</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">84</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">182</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">162</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">135</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">76</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">10</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">69</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">246</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">195</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">152</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">133</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">88</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">229</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">104</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">111</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">22</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">39</span><span style="color:#ccc9c2;">]
seeds </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[</span><span style="color:#ffcc66;">9925</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">8861</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">5738</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">1649</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">2696</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">6926</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">1839</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">7825</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">6434</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">9699</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">227</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">7379</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">9024</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">817</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">4022</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">7129</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">1096</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">4149</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">6147</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">2966</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">1027</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">4350</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">4272</span><span style="color:#ccc9c2;">]

</span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f28779;">len</span><span style="color:#ccc9c2;">(res)):
    random</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">seed</span><span style="color:#ccc9c2;">(seeds[i])
    rands </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[]
    </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">j </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">4</span><span style="color:#ccc9c2;">):
        rands</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span style="color:#ccc9c2;">(random</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">randint</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">255</span><span style="color:#ccc9c2;">))
    </span><span style="color:#f28779;">print</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">chr</span><span style="color:#ccc9c2;">(rands[i</span><span style="color:#f29e74;">%</span><span style="color:#ffcc66;">4</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">^ </span><span style="color:#ccc9c2;">res[i])</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">end</span><span style="color:#f29e74;">=</span><span style="color:#bae67e;">&quot;&quot;</span><span style="color:#ccc9c2;">)
</span></code></pre><h3 id="find-largest-triangle">find largest triangle</h3>
<pre style="background-color:#212733;">
<code class="language-python" data-lang="python"><span style="font-style:italic;color:#5c6773;">#determinant of matrix a
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">det</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">a</span><span style="color:#ccc9c2;">):
    </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">][</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]

</span><span style="font-style:italic;color:#5c6773;">#unit normal vector of plane defined by points a, b, and c
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">unit_normal</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">a</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">b</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">c</span><span style="color:#ccc9c2;">):
    x </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">det</span><span style="color:#ccc9c2;">([[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">c[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">c[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]])
    y </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">det</span><span style="color:#ccc9c2;">([[a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[b[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[c[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">c[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]]])
    z </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">det</span><span style="color:#ccc9c2;">([[a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[b[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,
             </span><span style="color:#ccc9c2;">[c[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;">c[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]])
    magnitude </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">(x</span><span style="color:#f29e74;">**</span><span style="color:#ffcc66;">2 </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">y</span><span style="color:#f29e74;">**</span><span style="color:#ffcc66;">2 </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">z</span><span style="color:#f29e74;">**</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">)</span><span style="color:#f29e74;">**</span><span style="color:#ccc9c2cc;">.</span><span style="color:#ffcc66;">5
    </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">(x</span><span style="color:#f29e74;">/</span><span style="color:#ccc9c2;">magnitude</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">y</span><span style="color:#f29e74;">/</span><span style="color:#ccc9c2;">magnitude</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">z</span><span style="color:#f29e74;">/</span><span style="color:#ccc9c2;">magnitude)

</span><span style="font-style:italic;color:#5c6773;">#dot product of vectors a and b
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">dot</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">a</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">b</span><span style="color:#ccc9c2;">):
    </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+ </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]</span><span style="color:#f29e74;">*</span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]

</span><span style="font-style:italic;color:#5c6773;">#cross product of vectors a and b
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">cross</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">a</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">b</span><span style="color:#ccc9c2;">):
    x </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]
    y </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]
    z </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">- </span><span style="color:#ccc9c2;">a[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">* </span><span style="color:#ccc9c2;">b[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]
    </span><span style="color:#ffa759;">return </span><span style="color:#ccc9c2;">(x</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">y</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">z)


</span><span style="font-style:italic;color:#5c6773;">#area of polygon poly
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">area</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">poly</span><span style="color:#ccc9c2;">):
    </span><span style="color:#ffa759;">if </span><span style="color:#f28779;">len</span><span style="color:#ccc9c2;">(poly) </span><span style="color:#f29e74;">&lt; </span><span style="color:#ffcc66;">3</span><span style="color:#ccc9c2;">: </span><span style="font-style:italic;color:#5c6773;"># not a plane - no area
        </span><span style="color:#ffa759;">return </span><span style="color:#ffcc66;">0

    </span><span style="color:#ccc9c2;">total </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]
    </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">len</span><span style="color:#ccc9c2;">(poly)):
        vi1 </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">poly[i]
        </span><span style="color:#ffa759;">if </span><span style="color:#ccc9c2;">i </span><span style="color:#f29e74;">is </span><span style="color:#f28779;">len</span><span style="color:#ccc9c2;">(poly)</span><span style="color:#f29e74;">-</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">:
            vi2 </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">poly[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]
        </span><span style="color:#ffa759;">else</span><span style="color:#ccc9c2;">:
            vi2 </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">poly[i</span><span style="color:#f29e74;">+</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]
        prod </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">cross</span><span style="color:#ccc9c2;">(vi1</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">vi2)
        total[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+= </span><span style="color:#ccc9c2;">prod[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]
        total[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+= </span><span style="color:#ccc9c2;">prod[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]
        total[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">] </span><span style="color:#f29e74;">+= </span><span style="color:#ccc9c2;">prod[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]
    result </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">dot</span><span style="color:#ccc9c2;">(total</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffd580;">unit_normal</span><span style="color:#ccc9c2;">(poly[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">poly[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">]</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">poly[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">]))
    </span><span style="color:#ffa759;">return </span><span style="color:#f28779;">abs</span><span style="color:#ccc9c2;">(result</span><span style="color:#f29e74;">/</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">)
</span><span style="color:#ffa759;">from </span><span style="color:#ccc9c2;">itertools </span><span style="color:#ffa759;">import </span><span style="color:#ccc9c2;">combinations

</span><span style="font-style:italic;color:#5c6773;"># points is a list of 3D points
# ie: [[2, 9, -15], [0, 33, -20], ...]
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">FindLargestTriangleArea</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">points</span><span style="color:#ccc9c2;">):
  </span><span style="font-style:italic;color:#5c6773;"># return largest area
  </span><span style="color:#ffa759;">return </span><span style="color:#f28779;">max</span><span style="color:#ccc9c2;">([</span><span style="color:#ffd580;">area</span><span style="color:#ccc9c2;">(x) </span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">x </span><span style="color:#ffa759;">in </span><span style="color:#ffd580;">combinations</span><span style="color:#ccc9c2;">(points</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffcc66;">3</span><span style="color:#ccc9c2;">)])

</span><span style="font-style:italic;color:#5c6773;"># Reading space delimited points from stdin
# and building list of 3D points
# points_data = &quot;-21,59,-93 -4,91,-2 1,61,2, 0,44,1&quot;
</span><span style="color:#ccc9c2;">points_data </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">raw_input</span><span style="color:#ccc9c2;">()
points </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">[]
</span><span style="color:#ffa759;">for </span><span style="color:#ccc9c2;">point </span><span style="color:#ffa759;">in </span><span style="color:#ccc9c2;">points_data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&#39; &#39;</span><span style="color:#ccc9c2;">):
  point_xyz </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">point</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&#39;,&#39;</span><span style="color:#ccc9c2;">)
  points</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span style="color:#ccc9c2;">([</span><span style="font-style:italic;color:#5ccfe6;">int</span><span style="color:#ccc9c2;">(point_xyz[</span><span style="color:#ffcc66;">0</span><span style="color:#ccc9c2;">])</span><span style="color:#ccc9c2cc;">, </span><span style="font-style:italic;color:#5ccfe6;">int</span><span style="color:#ccc9c2;">(point_xyz[</span><span style="color:#ffcc66;">1</span><span style="color:#ccc9c2;">])</span><span style="color:#ccc9c2cc;">, </span><span style="font-style:italic;color:#5ccfe6;">int</span><span style="color:#ccc9c2;">(point_xyz[</span><span style="color:#ffcc66;">2</span><span style="color:#ccc9c2;">])])

</span><span style="font-style:italic;color:#5c6773;"># Compute Largest Triangle and Print Area rounded to nearest whole number
</span><span style="color:#ccc9c2;">area </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">FindLargestTriangleArea</span><span style="color:#ccc9c2;">(points)
</span><span style="color:#f28779;">print</span><span style="color:#ccc9c2;">(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">round</span><span style="color:#ccc9c2;">(area)))
</span></code></pre><h3 id="we-need-an-emulator">we need an emulator</h3>
<pre style="background-color:#212733;">
<code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#5c6773;">/*
[package]
name = &quot;tenable-emu&quot;
version = &quot;0.1.0&quot;
authors = [&quot;Teddy Heinen &lt;teddy@heinen.dev&gt;&quot;]
edition = &quot;2018&quot;

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
nom = &quot;6.1.2&quot;
*/

</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">nom</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">branch</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">alt</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">nom</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">bytes</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">complete</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">{tag</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> take_until}</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">nom</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">combinator</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">opt</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">nom</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">multi</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">many1</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">nom</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">{Finish</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> IResult}</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span style="color:#ccc9c2;">std</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">collections</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">HashMap</span><span style="color:#ccc9c2cc;">;

#</span><span style="color:#ccc9c2;">[</span><span style="color:#ffd580;">derive</span><span style="color:#ccc9c2;">(Debug</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Copy</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Clone</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Hash</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Eq</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> PartialEq)]
</span><span style="color:#ffa759;">enum </span><span style="color:#73d0ff;">Register </span><span style="color:#ccc9c2;">{
    Trx</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">    Drx</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">}

</span><span style="color:#ccc9c2cc;">#</span><span style="color:#ccc9c2;">[</span><span style="color:#ffd580;">derive</span><span style="color:#ccc9c2;">(Debug</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Clone)]
</span><span style="color:#ffa759;">enum </span><span style="color:#73d0ff;">Instruction </span><span style="color:#ccc9c2;">{
    Xor(Register</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Register)</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">    MovL(Register</span><span style="color:#ccc9c2cc;">, </span><span style="font-style:italic;color:#5ccfe6;">String</span><span style="color:#ccc9c2;">)</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">    Mov(Register</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Register)</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">    Reverse(Register)</span><span style="color:#ccc9c2cc;">,
</span><span style="color:#ccc9c2;">}

</span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">instruction</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Instruction&gt; {
    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">register</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Register&gt; {
        </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">trx</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Register&gt; {
            </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;TRX&quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
            </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Register</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Trx))
        }

        </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">drx</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Register&gt; {
            </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;DRX&quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
            </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Register</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Drx))
        }
        </span><span style="color:#f28779;">alt</span><span style="color:#ccc9c2;">((trx</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> drx))(input)
    }

    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">xor</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Instruction&gt; {
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;XOR &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> lhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot; &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">opt</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\r\n</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">))(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Xor(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs)))
    }

    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">movl</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Instruction&gt; {
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;MOV &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> lhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot; </span><span style="color:#95e6cb;">\&quot;</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">take_until</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\&quot;</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\&quot;</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">opt</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\r\n</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">))(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">MovL(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to_string</span><span style="color:#ccc9c2;">())))
    }

    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">mov</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Instruction&gt; {
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;MOV &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> lhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot; &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">opt</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\r\n</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">))(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Mov(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs)))
    }
    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">reverse</span><span style="color:#ccc9c2;">(</span><span style="color:#ffcc66;">input</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#ccc9c2;">IResult&lt;</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">str</span><span style="color:#ccc9c2;">, Instruction&gt; {
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;REVERSE &quot;</span><span style="color:#ccc9c2;">)(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> lhs) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">register</span><span style="color:#ccc9c2;">(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">opt</span><span style="color:#ccc9c2;">(</span><span style="color:#f28779;">tag</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\r\n</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2;">))(input)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
        </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span style="color:#ccc9c2;">((input</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Reverse(lhs)))
    }

    </span><span style="color:#f28779;">alt</span><span style="color:#ccc9c2;">((xor</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> movl</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> mov</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> reverse))(input)
}

</span><span style="color:#ccc9c2cc;">#</span><span style="color:#ccc9c2;">[</span><span style="color:#ffd580;">derive</span><span style="color:#ccc9c2;">(Debug</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Default</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> Clone)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">State </span><span style="color:#ccc9c2;">{
    registers</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ccc9c2;">HashMap&lt;Register, </span><span style="font-style:italic;color:#5ccfe6;">Vec</span><span style="color:#ccc9c2;">&lt;</span><span style="color:#ffa759;">u8</span><span style="color:#ccc9c2;">&gt;&gt;,
}

</span><span style="color:#ffa759;">impl </span><span style="color:#73d0ff;">State </span><span style="color:#ccc9c2;">{
    </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">apply</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">mut </span><span style="color:#ffcc66;">self</span><span style="color:#ccc9c2;">, </span><span style="color:#ffcc66;">instr</span><span style="color:#ccc9c2cc;">:</span><span style="color:#ccc9c2;"> Instruction) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">mut Self </span><span style="color:#ccc9c2;">{
        </span><span style="color:#ffa759;">match</span><span style="color:#ccc9c2;"> instr {
            Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Xor(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">=&gt; </span><span style="color:#ccc9c2;">{
                </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> lhs_reg </span><span style="color:#f29e74;">= </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">lhs)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">;
                </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> rhs_reg </span><span style="color:#f29e74;">= </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">rhs)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">;

                </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> new_val </span><span style="color:#f29e74;">=</span><span style="color:#ccc9c2;"> lhs_reg
                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">into_iter</span><span style="color:#ccc9c2;">()
                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">enumerate</span><span style="color:#ccc9c2;">()
                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">map</span><span style="color:#ccc9c2;">(|(</span><span style="color:#ffcc66;">index</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">x</span><span style="color:#ccc9c2;">)| x </span><span style="color:#f29e74;">^</span><span style="color:#ccc9c2;"> rhs_reg</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(index)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap_or</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffcc66;">0</span><span style="color:#ffa759;">u8</span><span style="color:#ccc9c2;">))
                    </span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">collect</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">&lt;</span><span style="font-style:italic;color:#5ccfe6;">Vec</span><span style="color:#ccc9c2;">&lt;</span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">&gt;&gt;()</span><span style="color:#ccc9c2cc;">;

                </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> new_val)</span><span style="color:#ccc9c2cc;">;
            </span><span style="color:#ccc9c2;">}
            Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">MovL(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">=&gt; </span><span style="color:#ccc9c2;">{
                </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">bytes</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">collect</span><span style="color:#ccc9c2;">())</span><span style="color:#ccc9c2cc;">;
            </span><span style="color:#ccc9c2;">}
            Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Mov(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs) </span><span style="color:#f29e74;">=&gt; </span><span style="color:#ccc9c2;">{
                </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> rhs_reg </span><span style="color:#f29e74;">= </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">rhs)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">;
                </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> rhs_reg)</span><span style="color:#ccc9c2cc;">;
            </span><span style="color:#ccc9c2;">}
            Instruction</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Reverse(lhs) </span><span style="color:#f29e74;">=&gt; </span><span style="color:#ccc9c2;">{
                </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> lhs_reg </span><span style="color:#f29e74;">= </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">lhs)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">;
                </span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers
                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(lhs</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> lhs_reg</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">iter</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">cloned</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">rev</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">collect</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">&lt;</span><span style="font-style:italic;color:#5ccfe6;">Vec</span><span style="color:#ccc9c2;">&lt;</span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2;">&gt;&gt;())</span><span style="color:#ccc9c2cc;">;
            </span><span style="color:#ccc9c2;">}
        }</span><span style="color:#ccc9c2cc;">;
        </span><span style="font-style:italic;color:#5ccfe6;">self
    </span><span style="color:#ccc9c2;">}
}

</span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span style="color:#ccc9c2;">() {
    </span><span style="color:#ffa759;">let</span><span style="color:#ccc9c2;"> crypto </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">include_str!</span><span style="color:#ccc9c2;">(</span><span style="color:#bae67e;">&quot;../../Crypto.asm&quot;</span><span style="color:#ccc9c2;">)</span><span style="color:#ccc9c2cc;">;

    </span><span style="color:#ffa759;">let </span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">_</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ccc9c2;"> instructions) </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">many1</span><span style="color:#ccc9c2;">(instruction)(crypto)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">finish</span><span style="color:#ccc9c2;">()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()</span><span style="color:#ccc9c2cc;">;

    </span><span style="color:#ffa759;">let mut</span><span style="color:#ccc9c2;"> state </span><span style="color:#f29e74;">= </span><span style="color:#ccc9c2;">State</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">default()</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">    state
        </span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers
        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(Register</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Trx</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;GED</span><span style="color:#95e6cb;">\x03</span><span style="color:#bae67e;">hG</span><span style="color:#95e6cb;">\x15</span><span style="color:#bae67e;">&amp;Ka =;</span><span style="color:#95e6cb;">\x0c\x1a</span><span style="color:#bae67e;">31o*5M&quot;</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to_vec</span><span style="color:#ccc9c2;">())</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">    state</span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">insert</span><span style="color:#ccc9c2;">(Register</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Drx</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;&quot;</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to_vec</span><span style="color:#ccc9c2;">())</span><span style="color:#ccc9c2cc;">;
    </span><span style="color:#f28779;">println!</span><span style="color:#ccc9c2;">(
        </span><span style="color:#bae67e;">&quot;</span><span style="color:#ffcc66;">{:?}</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2cc;">,
        </span><span style="font-style:italic;color:#5ccfe6;">String</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">from_utf8_lossy(
            </span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">instructions
                </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">into_iter</span><span style="color:#ccc9c2;">()
                </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">fold</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">mut</span><span style="color:#ccc9c2;"> state</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ccc9c2;">|</span><span style="color:#ffcc66;">st</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">instr</span><span style="color:#ccc9c2;">| st</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">apply</span><span style="color:#ccc9c2;">(instr))
                </span><span style="color:#f29e74;">.</span><span style="color:#ccc9c2;">registers
                </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">get</span><span style="color:#ccc9c2;">(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ccc9c2;">Register</span><span style="color:#f29e74;">::</span><span style="color:#ccc9c2;">Trx)
                </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span style="color:#ccc9c2;">()
                </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span style="color:#ccc9c2;">()
        )
    )</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ccc9c2;">}
</span></code></pre>
    </div>

    
    <div class="article-info">
        
        <div class="article-date">20 February 2021</div>
        
        <div class="article-taxonomies">
            
            
                <ul class="article-tags">
                    
                    <li><a href="https://heinen.dev/tags/ctf-writeups/">#ctf-writeups</a></li>
                    
                </ul>
            
        </div>
    </div>

</article>


        </main>
        <footer>
            
            
        </footer>
    </div>
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "1e533cda4e344b0bb7c6bf7aef70a519"}'></script>
    <!-- End Cloudflare Web Analytics -->
</body>
</html>
